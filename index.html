<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Dashboard</title>
  <link rel="stylesheet" href="dashboard.css" />
  <link rel="stylesheet" href="top-navigation.css" />
  <link rel="stylesheet" href="monitor.css" />
  <!-- Font Awesome (for icons if needed, optional) -->
  <link rel="manifest" href="manifest.json" />
  <!-- Helper for local screenshot fallback (optional) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>

<body>
  <div id="topnav-container"></div>
  <script src="top-navigation.js"></script>

  <main class="dashboard">

    <!-- Card 1: Complex Swiper Card (Zone Status + Screenshot) -->
    <div class="card complex-card">
      <div class="swiper-container" id="monitor-swiper">
        <div class="swiper-wrapper">

          <!-- Slide A: Live Zone Status -->
          <div class="swiper-slide zone-slide">
            <div class="header-section" style="margin-bottom: 20px;">
              <h1 style="font-size: 2rem; margin-bottom: 5px;">Live Zone Status</h1>
              <p class="subtitle" style="font-size: 1rem;">Real-time emergency department capacity</p>
              <div id="last-updated" class="last-updated" style="font-size: 0.8rem;">Waiting for current data...</div>
            </div>

            <div class="stats-grid">
              <!-- Green Zone -->
              <div class="stat-card green-zone">
                <div class="card-header">
                  <div class="zone-icon">üü¢</div>
                  <h2>Green Zone</h2>
                </div>
                <div class="main-metric">
                  <span class="seen-count" id="g-seen">0</span>
                  <span class="separator">/</span>
                  <span class="total-count" id="g-total">0</span>
                  <span class="unit">Seen</span>
                </div>
                <div class="progress-container">
                  <div class="progress-bar" id="g-bar" style="width: 0%"></div>
                </div>
                <div class="breach-stats">
                  <div class="breach-item">
                    <span class="label">> 4 Hours</span>
                    <span class="value" id="g-4h">0</span>
                  </div>
                  <div class="breach-item warning">
                    <span class="label">> 6 Hours</span>
                    <span class="value" id="g-6h">0</span>
                  </div>
                </div>
              </div>

              <!-- Yellow Zone -->
              <div class="stat-card yellow-zone">
                <div class="card-header">
                  <div class="zone-icon">üü°</div>
                  <h2>Yellow Zone</h2>
                </div>
                <div class="main-metric">
                  <span class="seen-count" id="y-seen">0</span>
                  <span class="separator">/</span>
                  <span class="total-count" id="y-total">0</span>
                  <span class="unit">Seen</span>
                </div>
                <div class="progress-container">
                  <div class="progress-bar" id="y-bar" style="width: 0%"></div>
                </div>
                <div class="breach-stats">
                  <div class="breach-item">
                    <span class="label">> 4 Hours</span>
                    <span class="value" id="y-4h">0</span>
                  </div>
                  <div class="breach-item warning">
                    <span class="label">> 6 Hours</span>
                    <span class="value" id="y-6h">0</span>
                  </div>
                </div>
              </div>

              <!-- Red Zone -->
              <div class="stat-card red-zone">
                <div class="card-header">
                  <div class="zone-icon">üî¥</div>
                  <h2>Red Zone</h2>
                </div>
                <div class="main-metric">
                  <span class="seen-count" id="r-seen">0</span>
                  <span class="separator">/</span>
                  <span class="total-count" id="r-total">0</span>
                  <span class="unit">Seen</span>
                </div>
                <div class="progress-container">
                  <div class="progress-bar" id="r-bar" style="width: 0%"></div>
                </div>
                <div class="breach-stats">
                  <div class="breach-item">
                    <span class="label">> 4 Hours</span>
                    <span class="value" id="r-4h">0</span>
                  </div>
                  <div class="breach-item warning">
                    <span class="label">> 6 Hours</span>
                    <span class="value" id="r-6h">0</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- End Slide A -->

          <!-- Slide B: Live Screenshot -->
          <div class="swiper-slide screenshot-slide">
            <h2>Live Screenshot</h2>
            <p class="subtitle" style="font-size: 1rem; margin-bottom: 20px;">View real-time dashboard from host</p>

            <div class="screenshot-placeholder" id="screenshot-container">
              <span id="screenshot-placeholder-text">Tap "Capture Live" below</span>
              <img id="live-screenshot-img" src="" alt="Live Screenshot">
            </div>

            <button id="remote-screenshot-btn" class="btn-live-screenshot">üì° Capture Live</button>
          </div>
          <!-- End Slide B -->

        </div>
      </div>

      <!-- Pagination Dots -->
      <div class="swiper-pagination">
        <div class="swiper-dot active"></div>
        <div class="swiper-dot"></div>
      </div>
    </div>

    <!-- Referral Card -->
    <div class="card" onclick="location.href='webform1.html'">
      <h2>üìù Referral from FMC/PKU</h2>
      <p>Fill in and submit the form if receiving pt from FMC or PKU</p>
    </div>

    <!-- Coming Soon Card -->
    <div class="card">
      <h2>üîó Coming Soon</h2>
      <p>More features will be added here.</p>
    </div>
  </main>

  <!-- IMPORTANT: Logic for Swiper Dots -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const swiper = document.querySelector('.swiper-container');
      const dots = document.querySelectorAll('.swiper-dot');

      if (swiper) {
        swiper.addEventListener('scroll', () => {
          const scrollPosition = swiper.scrollLeft;
          const width = swiper.offsetWidth;
          // Simple logic: if scrolled more than halfway, activate second dot
          const activeIndex = Math.round(scrollPosition / width);

          dots.forEach((dot, index) => {
            if (index === activeIndex) dot.classList.add('active');
            else dot.classList.remove('active');
          });
        });
      }
    });
  </script>

  <script src="app.js"></script>
  <script src="monitor.js"></script>

  <div id="navbar-container"></div>
  <script>
    fetch('navbar.html')
      .then(res => res.text())
      .then(html => {
        document.getElementById('navbar-container').innerHTML = html;
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = 'navbar.css';
        document.head.appendChild(link);
      });
  </script>

</body>

</html>